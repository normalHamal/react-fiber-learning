<!DOCTYPE html>
<html style="width: 100%; height: 100%; overflow: hidden">
  <head>
    <meta charset="utf-8">
    <title>Fiber reconciliation</title>
  </head>
  <body>
    <div id="container">
    </div>
    <script src="js/react.development.js"></script>
    <script src="js/react-dom.development.js"></script>
    <script src="js/scheduler.development.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.8.24/browser.min.js"></script>
    <script type="text/babel">
const Low = (props) => <h2>{props.text}</h2>

class App extends React.Component {
  constructor() {
    super();
    this.state = { text: '' };
  }

  handleClick() {
    // A1 - B2 - C1 - D2
    Scheduler.unstable_runWithPriority(Scheduler.unstable_UserBlockingPriority, () => {
      console.log('%c Insert Update A1', 'color: #fff;background: #6190e8;');
      this.setState(state => ({
        text: state.text + 'A',
      }));
    });

    Scheduler.unstable_runWithPriority(Scheduler.unstable_NormalPriority, () => {
      console.log('%c Insert Update B2', 'color: #fff;background: #6190e8;');
      this.setState(state => ({
        text: state.text + 'B',
      }));
    });

    Scheduler.unstable_runWithPriority(Scheduler.unstable_UserBlockingPriority, () => {
      console.log('%c Insert Update C1', 'color: #fff;background: #6190e8;');
      this.setState(state => ({
        text: state.text + 'C',
      }));
    });

    Scheduler.unstable_runWithPriority(Scheduler.unstable_NormalPriority, () => {
      console.log('%c Insert Update D2', 'color: #fff;background: #6190e8;');
      this.setState(state => ({
        text: state.text + 'D',
      }));
    });
  }

  render() {
    const { text } = this.state;

    return (
      <React.Fragment>
        <button onClick={this.handleClick.bind(this)}>开始模拟调度</button>
        <Low text={text} />
      </React.Fragment>
    );
  }
}

ReactDOM.createRoot(
  document.getElementById('container')
).render(<App />);
    </script>
  </body>
</html>
